name: CI/CD para Proyecto PHP Clásico

on:
  push:
    branches:
      - main
  pull_request:
    branches:
      - main

jobs:
  build-and-run:
    runs-on: windows-latest

    steps:
      - name: Checkout code
        uses: actions/checkout@v3

      - name: Set up PHP
        uses: shivammathur/setup-php@v2
        with:
          php-version: '8.1'  # Puedes ajustar la versión de PHP según lo que utilices

      - name: Validate PHP syntax
        run: |
          dir /s /b *.php | ForEach-Object { php -l $_ }

      - name: List files in biblioteca directory
        run: dir /s biblioteca

      - name: List files in Controller directory
        run: dir /s biblioteca\Controller

      - name: Display content of Load.php
        run: type biblioteca\Libraries\Core\Load.php

      #- name: Run PHP Script
      #  run: php biblioteca\index.php

      # Opcional: Ejecutar análisis estático de código con PHPStan
      # - name: Configure PHPStan
      #   run: composer require --dev phpstan/phpstan
      # - name: Run PHPStan
      #   run: vendor\bin\phpstan analyse --level max

      # Opcional: Ejecutar pruebas unitarias
      # - name: Run unit tests
      #   run: phpunit --configuration phpunit.xml
